/*! For license information please see embed.js.LICENSE.txt */
(()=>{function n(){var t,o,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function c(n,r,i,a){var c=r&&r.prototype instanceof l?r:l,u=Object.create(c.prototype);return e(u,"_invoke",function(n,e,r){var i,a,c,l=0,u=r||[],s=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return i=n,a=0,c=t,f.n=e,d}};function p(n,e){for(a=n,c=e,o=0;!s&&l&&!r&&o<u.length;o++){var r,i=u[o],p=f.p,v=i[2];n>3?(r=v===e)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=p&&((r=n<2&&p<i[1])?(a=0,f.v=e,f.n=i[1]):p<v&&(r=n<3||i[0]>e||e>v)&&(i[4]=n,i[5]=e,f.n=v,a=0))}if(r||n>1)return d;throw s=!0,e}return function(r,u,v){if(l>1)throw TypeError("Generator is already running");for(s&&1===u&&p(u,v),a=u,c=v;(o=a<2?t:c)||!s;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(l=2,i){if(a||(r="next"),o=i[r]){if(!(o=o.call(i,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,a<2&&(a=0)}else 1===a&&(o=i.return)&&o.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=t}else if((o=(s=f.n<0)?c:n.call(e,f))!==d)break}catch(n){i=t,a=1,c=n}finally{l=1}}return{value:o,done:s}}}(n,i,a),!0),u}var d={};function l(){}function u(){}function s(){}o=Object.getPrototypeOf;var f=[][i]?o(o([][i]())):(e(o={},i,function(){return this}),o),p=s.prototype=l.prototype=Object.create(f);function v(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,s):(n.__proto__=s,e(n,a,"GeneratorFunction")),n.prototype=Object.create(p),n}return u.prototype=s,e(p,"constructor",s),e(s,"constructor",u),u.displayName="GeneratorFunction",e(s,a,"GeneratorFunction"),e(p),e(p,a,"Generator"),e(p,i,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:c,m:v}})()}function e(n,t,o,r){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}e=function(n,t,o,r){function a(t,o){e(n,t,function(n){return this._invoke(t,o,n)})}t?i?i(n,t,{value:o,enumerable:!r,configurable:!r,writable:!r}):n[t]=o:(a("next",0),a("throw",1),a("return",2))},e(n,t,o,r)}function t(n,e,t,o,r,i,a){try{var c=n[i](a),d=c.value}catch(n){return void t(n)}c.done?e(d):Promise.resolve(d).then(o,r)}!function(){"use strict";console.log("3D Store Widget initialized");var e=document.currentScript,o=e?e.getAttribute("data-store-id"):null,r=window.location.hostname,i=e&&e.getAttribute("data-api-url")||"http://localhost:8000";function a(){return c.apply(this,arguments)}function c(){var e;return e=n().m(function e(){var t,a,c,l,u,s,f;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,c=o?"".concat(i,"/api/stores/").concat(o):"".concat(i,"/api/widget/config?domain=").concat(r),n.n=1,fetch(c);case 1:if((l=n.v).ok){n.n=2;break}throw new Error("Failed to fetch widget config");case 2:return n.n=3,l.json();case 3:u=n.v,(s=o?{videoUrl:null===(t=u.widgetConfig)||void 0===t?void 0:t.videoUrl,clickableLink:null===(a=u.widgetConfig)||void 0===a?void 0:a.clickableLink}:u).videoUrl&&d(s),n.n=5;break;case 4:n.p=4,f=n.v,console.error("Widget error:",f);case 5:return n.a(2)}},e,null,[[0,4]])}),c=function(){var n=this,o=arguments;return new Promise(function(r,i){var a=e.apply(n,o);function c(n){t(a,r,i,c,d,"next",n)}function d(n){t(a,r,i,c,d,"throw",n)}c(void 0)})},c.apply(this,arguments)}function d(n){var e=document.createElement("div");e.id="3d-store-widget",document.body.appendChild(e);var t=e.attachShadow({mode:"open"}),o=document.createElement("style");o.textContent="\n      :host {\n        all: initial;\n      }\n      .widget-container {\n        position: fixed;\n        bottom: 20px;\n        left: 20px;\n        z-index: 999999;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      }\n      .video-banner {\n        width: 300px;\n        border-radius: 12px;\n        overflow: hidden;\n        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);\n        cursor: pointer;\n        transition: transform 0.2s;\n      }\n      .video-banner:hover {\n        transform: scale(1.05);\n      }\n      .video-banner video {\n        width: 100%;\n        height: auto;\n        display: block;\n      }\n      .modal-overlay {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background: rgba(0, 0, 0, 0.8);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 1000000;\n      }\n      .modal-content {\n        position: relative;\n        width: 90%;\n        max-width: 1200px;\n        height: 80vh;\n        background: white;\n        border-radius: 12px;\n        overflow: hidden;\n      }\n      .modal-close {\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        background: rgba(0, 0, 0, 0.7);\n        color: white;\n        border: none;\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        cursor: pointer;\n        font-size: 24px;\n        z-index: 10;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      .modal-close:hover {\n        background: rgba(0, 0, 0, 0.9);\n      }\n      iframe {\n        width: 100%;\n        height: 100%;\n        border: none;\n      }\n    ",t.appendChild(o);var r=document.createElement("div");r.className="widget-container",r.innerHTML='\n      <div class="video-banner">\n        <video autoplay loop muted playsinline>\n          <source src="'.concat(n.videoUrl,'" type="video/mp4">\n        </video>\n      </div>\n    '),t.appendChild(r),l("widget_loaded");var i=r.querySelector(".video-banner");r.querySelector("video").addEventListener("loadeddata",function(){l("video_loaded")}),i.addEventListener("click",function(){l("video_clicked"),function(n){var e=document.querySelector("#3d-store-widget").shadowRoot,t=document.createElement("div");t.className="modal-overlay",t.innerHTML='\n      <div class="modal-content">\n        <button class="modal-close">Ã—</button>\n        <iframe src="'.concat(n,'"></iframe>\n      </div>\n    '),e.appendChild(t),t.querySelector(".modal-close").addEventListener("click",function(){t.remove()}),t.addEventListener("click",function(n){n.target===t&&t.remove()})}(n.clickableLink)})}function l(n){console.log("Widget event:",n),"undefined"!=typeof gtag&&gtag("event",n,{event_category:"3d_store_widget",event_label:r||o})}o||r?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a():console.error("Widget: No store ID or domain provided")}()})();